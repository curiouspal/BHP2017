---
title: "Comparing BSH households with the non-BSH households"
date: "September 30, 2017"
output: word_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message = FALSE, echo=FALSE, message=FALSE}
load("/media/anirban/a84ef5e0-59cf-454d-aeae-e112c9915900/home/anirban/Documents/BHP-New/BHP-2017-roundData/combined-Sept30-2017.RData")
final <- subset(final, From_15 == "ph2015" | From_17 == "allbsh.RData" | From_17 == "ph2017")
final <- subset(final, PH_or_S8 == "PH")
library("ggplot2")
library("plyr")
#library("dplyr")
#library("pander")
library("reshape2")
library("scales")
library(readr)

#panderOptions("table.split.table", Inf)

```

```{r, echo=FALSE}
final$Q8_1_17 <- NA
final$Q8_1_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_1_17[i]) & !is.na(final$Q8_2_1_17[i])) {
  if(final$Q8_1_1_17[i] == "No" | final$Q8_2_1_17[i] == "No") final$Q8_1_17[i] <- "No"
  if(final$Q8_1_1_17[i] == "Yes" | final$Q8_2_1_17[i] == "Yes") final$Q8_1_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_1_17[i]) & !is.na(final$Q8_2_1_17[i])){
  if(final$Q8_1_1_17[i] == "No" | final$Q8_2_1_17[i] == "No") final$Q8_1_17[i] <- "No"
  if(final$Q8_1_1_17[i] == "Yes" | final$Q8_2_1_17[i] == "Yes") final$Q8_1_17[i] <- "Yes"
}
final$Q8_1_17 <- as.factor(final$Q8_1_17)
final$Q8_1_17 <- as.factor(final$Q8_1_17)





final$Q8_2_17 <- NA
final$Q8_2_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_2_17[i]) & !is.na(final$Q8_2_2_17[i])) {
  if(final$Q8_1_2_17[i] == "No" | final$Q8_2_2_17[i] == "No") final$Q8_2_17[i] <- "No"
  if(final$Q8_1_2_17[i] == "Yes" | final$Q8_2_2_17[i] == "Yes") final$Q8_2_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_2_17[i]) & !is.na(final$Q8_2_2_17[i])) {
  if(final$Q8_1_2_17[i] == "No" | final$Q8_2_2_17[i] == "No") final$Q8_2_17[i] <- "No"
  if(final$Q8_1_2_17[i] == "Yes" | final$Q8_2_2_17[i] == "Yes") final$Q8_2_17[i] <- "Yes"
}
final$Q8_2_17 <- as.factor(final$Q8_2_17)
final$Q8_2_17 <- as.factor(final$Q8_2_17)


final$Q8_3_17 <- NA
final$Q8_3_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_3_17[i]) & !is.na(final$Q8_2_3_17[i])) {
  if(final$Q8_1_3_17[i] == "No" | final$Q8_2_3_17[i] == "No") final$Q8_3_17[i] <- "No"
  if(final$Q8_1_3_17[i] == "Yes" | final$Q8_2_3_17[i] == "Yes") final$Q8_3_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_3_17[i]) & !is.na(final$Q8_2_3_17[i])) {
  if(final$Q8_1_3_17[i] == "No" | final$Q8_2_3_17[i] == "No") final$Q8_3_17[i] <- "No"
  if(final$Q8_1_3_17[i] == "Yes" | final$Q8_2_3_17[i] == "Yes") final$Q8_3_17[i] <- "Yes"
}
final$Q8_3_17 <- as.factor(final$Q8_3_17)
final$Q8_3_17 <- as.factor(final$Q8_3_17)

final$Q8_4_17 <- NA
final$Q8_4_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_4_17[i]) & !is.na(final$Q8_2_4_17[i])) {
  if(final$Q8_1_4_17[i] == "No" | final$Q8_2_4_17[i] == "No") final$Q8_4_17[i] <- "No"
  if(final$Q8_1_4_17[i] == "Yes" | final$Q8_2_4_17[i] == "Yes") final$Q8_4_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_4_17[i]) & !is.na(final$Q8_2_4_17[i])) {
  if(final$Q8_1_4_17[i] == "No" | final$Q8_2_4_17[i] == "No") final$Q8_4_17[i] <- "No"
  if(final$Q8_1_4_17[i] == "Yes" | final$Q8_2_4_17[i] == "Yes") final$Q8_4_17[i] <- "Yes"
}

final$Q8_4_17 <- as.factor(final$Q8_4_17)
final$Q8_4_17 <- as.factor(final$Q8_4_17)


final$Q8_5_17 <- NA
final$Q8_5_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_5_17[i]) & !is.na(final$Q8_2_5_17[i])) {
  if(final$Q8_1_5_17[i] == "No" | final$Q8_2_5_17[i] == "No") final$Q8_5_17[i] <- "No"
  if(final$Q8_1_5_17[i] == "Yes" | final$Q8_2_5_17[i] == "Yes") final$Q8_5_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_5_17[i]) & !is.na(final$Q8_2_5_17[i])) {
  if(final$Q8_1_5_17[i] == "No" | final$Q8_2_5_17[i] == "No") final$Q8_5_17[i] <- "No"
  if(final$Q8_1_5_17[i] == "Yes" | final$Q8_2_5_17[i] == "Yes") final$Q8_5_17[i] <- "Yes"
}
final$Q8_5_17 <- as.factor(final$Q8_5_17)
final$Q8_5_17 <- as.factor(final$Q8_5_17)


final$Q8_6_17 <- NA
final$Q8_6_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_6_17[i]) & !is.na(final$Q8_2_6_17[i])) {
  if(final$Q8_1_6_17[i] == "No" | final$Q8_2_6_17[i] == "No") final$Q8_6_17[i] <- "No"
  if(final$Q8_1_6_17[i] == "Yes" | final$Q8_2_6_17[i] == "Yes") final$Q8_6_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_6_17[i]) & !is.na(final$Q8_2_6_17[i])) {
  if(final$Q8_1_6_17[i] == "No" | final$Q8_2_6_17[i] == "No") final$Q8_6_17[i] <- "No"
  if(final$Q8_1_6_17[i] == "Yes" | final$Q8_2_6_17[i] == "Yes") final$Q8_6_17[i] <- "Yes"
}

final$Q8_6_17 <- as.factor(final$Q8_6_17)
final$Q8_6_17 <- as.factor(final$Q8_6_17)


final$Q8_7_17 <- NA
final$Q8_7_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_7_17[i]) & !is.na(final$Q8_2_7_17[i])) {
  if(final$Q8_1_7_17[i] == "No" | final$Q8_2_7_17[i] == "No") final$Q8_7_17[i] <- "No"
  if(final$Q8_1_7_17[i] == "Yes" | final$Q8_2_7_17[i] == "Yes") final$Q8_7_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_7_17[i]) & !is.na(final$Q8_2_7_17[i])) {
  if(final$Q8_1_7_17[i] == "No" | final$Q8_2_7_17[i] == "No") final$Q8_7_17[i] <- "No"
  if(final$Q8_1_7_17[i] == "Yes" | final$Q8_2_7_17[i] == "Yes") final$Q8_7_17[i] <- "Yes"
}

final$Q8_7_17 <- as.factor(final$Q8_7_17)
final$Q8_7_17 <- as.factor(final$Q8_7_17)

final$Q8_8_17 <- NA
final$Q8_8_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_8_17[i]) & !is.na(final$Q8_2_8_17[i])) {
  if(final$Q8_1_8_17[i] == "No" | final$Q8_2_8_17[i] == "No") final$Q8_8_17[i] <- "No"
  if(final$Q8_1_8_17[i] == "Yes" | final$Q8_2_8_17[i] == "Yes") final$Q8_8_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_8_17[i]) & !is.na(final$Q8_2_8_17[i])) {
  if(final$Q8_1_8_17[i] == "No" | final$Q8_2_8_17[i] == "No") final$Q8_8_17[i] <- "No"
  if(final$Q8_1_8_17[i] == "Yes" | final$Q8_2_8_17[i] == "Yes") final$Q8_8_17[i] <- "Yes"
}

final$Q8_8_17 <- as.factor(final$Q8_8_17)
final$Q8_8_17 <- as.factor(final$Q8_8_17)


final$Q8_9_17 <- NA
final$Q8_9_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_9_17[i]) & !is.na(final$Q8_2_9_17[i])) {
  if(final$Q8_1_9_17[i] == "No" | final$Q8_2_9_17[i] == "No") final$Q8_9_17[i] <- "No"
  if(final$Q8_1_9_17[i] == "Yes" | final$Q8_2_9_17[i] == "Yes") final$Q8_9_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_9_17[i]) & !is.na(final$Q8_2_9_17[i])) {
  if(final$Q8_1_9_17[i] == "No" | final$Q8_2_9_17[i] == "No") final$Q8_9_17[i] <- "No"
  if(final$Q8_1_9_17[i] == "Yes" | final$Q8_2_9_17[i] == "Yes") final$Q8_9_17[i] <- "Yes"
}

final$Q8_9_17 <- as.factor(final$Q8_9_17)
final$Q8_9_17 <- as.factor(final$Q8_9_17)


final$Q8_10_17 <- NA
final$Q8_10_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_10_17[i]) & !is.na(final$Q8_2_10_17[i])) {
  if(final$Q8_1_10_17[i] == "No" | final$Q8_2_10_17[i] == "No") final$Q8_10_17[i] <- "No"
  if(final$Q8_1_10_17[i] == "Yes" | final$Q8_2_10_17[i] == "Yes") final$Q8_10_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_10_17[i]) & !is.na(final$Q8_2_10_17[i])) {
  if(final$Q8_1_10_17[i] == "No" | final$Q8_2_10_17[i] == "No") final$Q8_10_17[i] <- "No"
  if(final$Q8_1_10_17[i] == "Yes" | final$Q8_2_10_17[i] == "Yes") final$Q8_10_17[i] <- "Yes"
}

final$Q8_10_17 <- as.factor(final$Q8_10_17)
final$Q8_10_17 <- as.factor(final$Q8_10_17)


final$Q8_11_17 <- NA
final$Q8_11_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_11_17[i]) & !is.na(final$Q8_2_11_17[i])) {
  if(final$Q8_1_11_17[i] == "No" | final$Q8_2_11_17[i] == "No") final$Q8_11_17[i] <- "No"
  if(final$Q8_1_11_17[i] == "Yes" | final$Q8_2_11_17[i] == "Yes") final$Q8_11_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_11_17[i]) & !is.na(final$Q8_2_11_17[i])) {
  if(final$Q8_1_11_17[i] == "No" | final$Q8_2_11_17[i] == "No") final$Q8_11_17[i] <- "No"
  if(final$Q8_1_11_17[i] == "Yes" | final$Q8_2_11_17[i] == "Yes") final$Q8_11_17[i] <- "Yes"
}

final$Q8_11_17 <- as.factor(final$Q8_11_17)
final$Q8_11_17 <- as.factor(final$Q8_11_17)


final$Q8_12_17 <- NA
final$Q8_12_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_12_17[i]) & !is.na(final$Q8_2_12_17[i])) {
  if(final$Q8_1_12_17[i] == "No" | final$Q8_2_12_17[i] == "No") final$Q8_12_17[i] <- "No"
  if(final$Q8_1_12_17[i] == "Yes" | final$Q8_2_12_17[i] == "Yes") final$Q8_12_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_12_17[i]) & !is.na(final$Q8_2_12_17[i])) {
  if(final$Q8_1_12_17[i] == "No" | final$Q8_2_12_17[i] == "No") final$Q8_12_17[i] <- "No"
  if(final$Q8_1_12_17[i] == "Yes" | final$Q8_2_12_17[i] == "Yes") final$Q8_12_17[i] <- "Yes"
}

final$Q8_12_17 <- as.factor(final$Q8_12_17)
final$Q8_12_17 <- as.factor(final$Q8_12_17)


final$Q8_13_17 <- NA
final$Q8_13_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_13_17[i]) & !is.na(final$Q8_2_13_17[i])) {
  if(final$Q8_1_13_17[i] == "No" | final$Q8_2_13_17[i] == "No") final$Q8_13_17[i] <- "No"
  if(final$Q8_1_13_17[i] == "Yes" | final$Q8_2_13_17[i] == "Yes") final$Q8_13_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_13_17[i]) & !is.na(final$Q8_2_13_17[i])) {
  if(final$Q8_1_13_17[i] == "No" | final$Q8_2_13_17[i] == "No") final$Q8_13_17[i] <- "No"
  if(final$Q8_1_13_17[i] == "Yes" | final$Q8_2_13_17[i] == "Yes") final$Q8_13_17[i] <- "Yes"
}

final$Q8_13_17 <- as.factor(final$Q8_13_17)
final$Q8_13_17 <- as.factor(final$Q8_13_17)


final$Q8_14_17 <- NA
final$Q8_14_17 <- NA

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_14_17[i]) & !is.na(final$Q8_2_14_17[i])) {
  if(final$Q8_1_14_17[i] == "No" | final$Q8_2_14_17[i] == "No") final$Q8_14_17[i] <- "No"
  if(final$Q8_1_14_17[i] == "Yes" | final$Q8_2_14_17[i] == "Yes") final$Q8_14_17[i] <- "Yes"
}

for(i in 1:length(final$TCode)) if(!is.na(final$Q8_1_14_17[i]) & !is.na(final$Q8_2_14_17[i])) {
  if(final$Q8_1_14_17[i] == "No" | final$Q8_2_14_17[i] == "No") final$Q8_14_17[i] <- "No"
  if(final$Q8_1_14_17[i] == "Yes" | final$Q8_2_14_17[i] == "Yes") final$Q8_14_17[i] <- "Yes"
}

final$Q8_14_17 <- as.factor(final$Q8_14_17)
final$Q8_14_17 <- as.factor(final$Q8_14_17)


```


Number of PH households who participated in the survey in 2017: 
```{r, echo=FALSE}
length(final$TCode[!is.na(final$From_17)])

ph2017 <- final$TCode[!is.na(final$From_17)]

```

Number of PH households who participated in the survey in 2017 AND are also part of the BSH program: 
```{r, echo=FALSE, message = FALSE}

BSH_list <- read_csv("/media/anirban/a84ef5e0-59cf-454d-aeae-e112c9915900/home/anirban/Documents/BHP-New/BHP-2017-roundData/BSH-list.csv", col_names = FALSE)
temp1<-data.frame(as.table(summary(as.factor(BSH_list$X1))))
BSH2017 <- intersect(as.character(ph2017), as.character(temp1$Var1))

length(BSH2017)

bsh <- final[final$TCode %in% BSH2017, ]
nonbsh <- final[!(final$TCode %in% BSH2017) & final$TCode %in% ph2017, ]
```

The following graphs compare the 35 households who completed the survey in nonbsh who are part of the BSH program with the 69 (104-35) households who are not in the BSH program. 

### **Housing**
```{r, message = FALSE, echo=FALSE, fig.height=4, fig.width=9}


x <- c("Q1: Prior housing was in subsidized\nhousing or was homeless or lived\nwith family/friends?", 
       "Q2: Expecting 3 years and above in\nfuture housing assistance?", 
       "Q4: Late rent 1 or more times in\nthe past 6 months?")

Q1Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q1_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q1_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("c. I lived in subsidized housing (for example, Section 8, Public Housing)", "d. I lived with family and friends", "e. I was homeless")]), na.rm = TRUE)
  no_bsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("b. I lived in private market rental housing (including student housing)")]), na.rm = TRUE)
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(bsh_a))[c("c. I lived in subsidized housing (for example, Section 8, Public Housing)", "d. I lived with family and friends", "e. I was homeless")]), na.rm = TRUE)
  no_nonbsh <- sum(as.integer(summary(as.factor(bsh_a))[c("a. Owned my home", "b. I lived in private market rental housing (including student housing)")]), na.rm = TRUE)
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

Q2Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q2_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q2_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("d. For the next 3 – 5 years", "e. For more than 5 years")]), na.rm = TRUE)
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("a. For the next 6 months", "b. For the next 7 – 12 months", "c. For the next 1 – 2 years")]), na.rm = TRUE)
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("d. For the next 3 – 5 years", "e. For more than 5 years")]), na.rm = TRUE)
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("a. For the next 6 months", "b. For the next 7 – 12 months", "c. For the next 1 – 2 years")]), na.rm = TRUE)
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

Q4Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q4_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q4_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("b. Yes, 1 time", "c. Yes, 2 times", "d. Yes, 3 times", "e. Yes, 4 or more times")]), na.rm = TRUE)
  no_bsh <- sum(as.integer(summary(as.factor(nonbsh_a))["a. No, never"]), na.rm = TRUE)
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("b. Yes, 1 time", "c. Yes, 2 times", "d. Yes, 3 times", "e. Yes, 4 or more times")]), na.rm = TRUE)
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))["a. No, never"]), na.rm = TRUE)
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}


pct_Yes_bsh <- pct_Yes_nonbsh <- c()

pct_Yes_bsh[1] <- Q1Yes()[1]
pct_Yes_nonbsh[1] <- Q1Yes()[2]
pct_Yes_bsh[2] <- Q2Yes()[1]
pct_Yes_nonbsh[2] <- Q2Yes()[2]
pct_Yes_bsh[3] <- Q4Yes()[1]
pct_Yes_nonbsh[3] <- Q4Yes()[2]


######################################################################
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 
d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")


ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes ") +
  xlab("") +
  ggtitle("\nHousing\n") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")


```


Q3: Barriers to SS in Housing
```{r, message = FALSE, echo=FALSE, fig.height=9, fig.width=9}

percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  yes_bsh <- as.integer(summary(as.factor(bsh_a))["Yes"])
  no_bsh <- as.integer(summary(as.factor(bsh_a))["No"])
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["Yes"])
  no_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["No"])
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q3_1: Not having a paying job", 
       "Q3_2: Low or no income", 
       "Q3_3: High basic expenses", 
       "Q3_4: Health issues", 
       "Q3_5: High childcare expenses", 
       "Q3_6: Being a single parent", 
       "Q3_7: Bad credit history", 
       "Q3_8: Not having the skills", 
       "Q3_9: High cost of housing")
pct_Yes_bsh <- pct_Yes_nonbsh <-c()
for(i in 1:9) {
  pct_Yes_bsh[i] <- percentYes(3, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(3, i)[2]
}

N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 
d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")


ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes ") +
  xlab("") +
  ggtitle("\nIs this a barrier to SS in Housing?\n") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")

##################################################################################


```


### **Employment**
```{r, message = FALSE, echo=FALSE, fig.height=4, fig.width=9}



x <- c("Q5: Employment Status\n(Unemployed including those\nnot seeking work)",
       "Q6: Want/need more hours\n(Definitely yes or probably yes)",
       "Q7: Skills qualify for better paying job\n(Definitely qualifies or\nsomewhat qualifies)")

Q5Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q5_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q5_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("d. Unemployed, and seeking work", "e. Unemployed and not seeking work")]))
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[levels(bsh$Q5_17)[1:3]]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("d. Unemployed, and seeking work", "e. Unemployed and not seeking work")]))
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[levels(nonbsh$Q5_17)[1:3]]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

Q6Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q6_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q6_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("a. Definitely yes", "b. Probably yes")]))
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("c. Not sure", "d. Probably not", "e. Definitely not")]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)

  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("a. Definitely yes", "b. Probably yes")]))
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("c. Not sure", "d. Probably not", "e. Definitely not")]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

Q7Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q7_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q7_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("4 My skills somehow qualify me for a better paying job.", "5 My skills definitely qualify me for a better paying job.")]))
  no_bsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("1 My skills do not qualify me for a better paying job at all.", "2 My skills somehow does not qualify me for a better paying job.", "3 Neutral.")]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("4 My skills somehow qualify me for a better paying job.", "5 My skills definitely qualify me for a better paying job.")]))
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("1 My skills do not qualify me for a better paying job at all.", "2 My skills somehow does not qualify me for a better paying job.", "3 Neutral.")]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}


pct_Yes_bsh <- pct_Yes_nonbsh <- c()

pct_Yes_bsh[1] <- Q5Yes()[1]
pct_Yes_nonbsh[1] <- Q5Yes()[2]
pct_Yes_bsh[2] <- Q6Yes()[1]
pct_Yes_nonbsh[2] <- Q6Yes()[2]
pct_Yes_bsh[3] <- Q7Yes()[1]
pct_Yes_nonbsh[3] <- Q7Yes()[2]


################################################
d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 
d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes ") +
  xlab("") +
  ggtitle("\nEmployment\n") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")

```







Q8: Barriers to SS in employment
```{r, message = FALSE, echo=FALSE, fig.height=12, fig.width=9, warning=FALSE}


percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  y_bsh <- as.integer(summary(as.factor(bsh_a))["Yes"])
  n_bsh <- as.integer(summary(as.factor(bsh_a))["No"])
  percent_y_bsh <- y_bsh * 100 / (y_bsh + n_bsh)
  
  y_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["Yes"])
  n_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["No"])
  percent_y_nonbsh <- y_nonbsh * 100 / (y_nonbsh + n_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q8_1: Being a student", 
       "Q8_2: Health problems", 
       "Q8_3: Lack of education or skills", 
       "Q8_4: Lack of work history", 
       "Q8_5: Transportation", 
       "Q8_6: English proficiency", 
       "Q8_7: Discrimination", 
       "Q8_8: Child care responsibilities", 
       "Q8_9: Experiencing domestic violence", 
       "Q8_10: Having a criminal record", 
       "Q8_11: Not enough time", 
       "Q8_12: Not knowing how to find a job",
       "Q8_13: Tight job market, bad economy", 
       "Q8_14: Immigration status")
pct_Yes_bsh <- pct_Yes_nonbsh <- c()
for(i in 1:14) {
  pct_Yes_bsh[i] <- percentYes(8, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(8, i)[2]
}


#############################################################################################3
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes") + 
  xlab(" ") + 
  ggtitle("\nIs this a barrier to employment?\n") +
  #scale_fill_discrete(name = "", labels = c("Y in '14, N in '15", "No change", "N in '14, Y in '15")) +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = .8), hjust=0.6, size=3, alpha=1) +
  scale_y_continuous(breaks= pretty_breaks()) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")


```



### **Income**
Q9: Income run out last 3 months?

```{r, message = FALSE, echo=FALSE, fig.height=3, fig.width=9}


x <- c("Q9")

Q9Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q9_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q9_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("b. Yes, 1 time", "c. Yes, 2 times", "d. Yes, 3 times", "e. Yes, 4 or more times")]))
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("a. No, never")]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("b. Yes, 1 time", "c. Yes, 2 times", "d. Yes, 3 times", "e. Yes, 4 or more times")]))
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("a. No, never")]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}



pct_Yes_bsh <- pct_Yes_nonbsh <- c()

pct_Yes_bsh[1] <- Q9Yes()[1]
pct_Yes_nonbsh[1] <- Q9Yes()[2]

N_bsh <- NA
N_nonbsh <- NA

for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes ") +
  xlab("") +
  ggtitle("\nIncome run out at least once in last 3 months?\n") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")


```

Q10: Very hard to pay for...
```{r, message = FALSE, echo=FALSE, fig.height=8, fig.width=9}


percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  sd_bsh <- as.integer(summary(as.factor(bsh_a))[2])
  vd_bsh <- as.integer(summary(as.factor(bsh_a))[1])
  tot_bsh <- length(bsh_a) - length(nonbsh_a[is.na(bsh_a)])
  percent_y_bsh <- (sd_bsh + vd_bsh)* 100 / (tot_bsh)

  
  sd_nonbsh <- as.integer(summary(as.factor(nonbsh_a))[2])
  vd_nonbsh <- as.integer(summary(as.factor(nonbsh_a))[1])
  tot_nonbsh <- length(nonbsh_a) - length(nonbsh_a[is.na(nonbsh_a)])
  percent_y_nonbsh <- (sd_nonbsh + vd_nonbsh)* 100 / (tot_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q10_1: Buying food", 
       "Q10_2: Having reliable housing", 
       "Q10_3: Getting health care", 
       "Q10_4: Having reliable transport", 
       "Q10_5: Having reliable child care", 
       "Q10_6: Making debt payments", 
       "Q10_7: Paying utilities", 
       "Q10_8: Saving money")
pct_Yes_bsh <- pct_Yes_nonbsh <- c()
for(i in 1:8) {
  pct_Yes_bsh[i] <- percentYes(10, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(10, i)[2]
}

N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered\n\"Very Difficult\" or \"Somewhat Difficult\" ") +
  xlab("") +
  ggtitle("\nVery hard to pay for...?\n") +
  #scale_fill_discrete(name = "", labels = c("Y in '14, N in '15", "No change", "N in '14, Y in '15")) +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=3.5, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")


```

### **Food**


```{r, echo=FALSE}
levQ11_17 <- c(levels(bsh$Q11_17))


bsh$Q11_17 <- ordered(bsh$Q11_17, levels=levQ11_17, labels=levQ11_17)
nonbsh$Q11_17 <- ordered(nonbsh$Q11_17, levels=levQ11_17, labels=levQ11_17)

```

```{r, message = FALSE, echo=FALSE, fig.height=4, fig.width=9}


x <- c("Q11: Cut/skip meal last 3 months?", 
       "Q12: Food sources except income?", 
       "Q14: Problems getting food?")

Q11Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q11_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q11_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[levQ11_17[-1]]))
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("a. No, never")]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[levQ11_17[-1]]))
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("a. No, never")]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

Q12Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q12_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q12_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))["Yes"]))
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("No")]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))["Yes"]))
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("No")]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

Q14Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q14_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q14_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))["Yes"]))
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("No")]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
 
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))["Yes"]))
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("No")]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}



pct_Yes_bsh <- pct_Yes_nonbsh <- c()

pct_Yes_bsh[1] <- Q11Yes()[1]
pct_Yes_nonbsh[1] <- Q11Yes()[2]
pct_Yes_bsh[2] <- Q12Yes()[1]
pct_Yes_nonbsh[2] <- Q12Yes()[2]
pct_Yes_bsh[3] <- Q14Yes()[1]
pct_Yes_nonbsh[3] <- Q14Yes()[2]

N_bsh <- NA
N_nonbsh <- NA

for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes ") +
  xlab("") +
  ggtitle("\nFood\n") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")


```


Q13: Food sources
```{r, message = FALSE, echo=FALSE, fig.height=6, fig.width=9, warning=FALSE}

percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  yes_bsh <- as.integer(summary(as.factor(bsh_a))["Yes"])
  no_bsh <- as.integer(summary(as.factor(bsh_a))["No"])
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)

  yes_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["Yes"])
  no_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["No"])
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q13_1: Food assistance (food stamps)", 
       "Q13_2: Food banks", 
       "Q13_3: Friends", 
       "Q13_4: Neighbors", 
       "Q13_5: Family members")
pct_Yes_bsh <- pct_Yes_nonbsh <- c()
for(i in 1:5) {
  pct_Yes_bsh[i] <- percentYes(13, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(13, i)[2]
}
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes") +
  xlab(" ") +
  ggtitle("\nFood sources") +
  #scale_fill_discrete(name = "", labels = c("Y in '14, N in '15", "No change", "N in '14, Y in '15")) +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.8), hjust=0.9, vjust=.5, size=3, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")

```

Q15: Food barriers
```{r, message = FALSE, echo=FALSE, fig.height=5.5, fig.width=9, warning=FALSE}

percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  yes_bsh <- as.integer(summary(as.factor(bsh_a))["Yes"])
  no_bsh <- as.integer(summary(as.factor(bsh_a))["No"])
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
 
  yes_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["Yes"])
  no_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["No"])
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q15_1: Lack of income", 
       "Q15_2: Lack of easy access to the stores", 
       "Q15_3: Lack of time to get to the stores", 
       "Q15_4: Lack of knowledge to find nutritious food")
pct_Yes_bsh <- pct_Yes_nonbsh <- c()

for(i in 1:4) {
  pct_Yes_bsh[i] <- percentYes(15, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(15, i)[2]
}
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "%; N=", as.character(d$N), sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes") +
  xlab(" ") +
  ggtitle("\nIs this a barrier to food?\n") +
  #scale_fill_discrete(name = "", labels = c("Y in '14, N in '15", "No change", "N in '14, Y in '15")) +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=.7, vjust=.1, size=3, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")


```



### **Transportation**
Q16: Transportation - satisfaction
```{r, message = FALSE, echo=FALSE, fig.height=6.5, fig.width=9, warning=FALSE}

percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  sd_bsh <- as.integer(summary(as.factor(bsh_a))[2])
  vd_bsh <- as.integer(summary(as.factor(bsh_a))[1])
  tot_bsh <- length(bsh_a) - length(bsh_a[is.na(bsh_a)])
  
  percent_y_bsh <- (sd_bsh + vd_bsh)* 100 / (tot_bsh)
  
  sd_nonbsh <- as.integer(summary(as.factor(nonbsh_a))[2])
  vd_nonbsh <- as.integer(summary(as.factor(nonbsh_a))[1])
  tot_nonbsh <- length(nonbsh_a) - length(nonbsh_a[is.na(nonbsh_a)])
  percent_y_nonbsh <- (sd_nonbsh + vd_nonbsh)* 100 / (tot_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q16_1: My own car", 
       "Q16_2: Carpool", 
       "Q16_3: Bus", 
       "Q16_4: Motorcycle",
       "Q16_5: Bicycle", 
       "Q16_6: Walking")

pct_Yes_bsh <- pct_Yes_nonbsh <- c()
for(i in 1:6) {
  pct_Yes_bsh[i] <- percentYes(16, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(16, i)[2]
}

N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")


ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered\n\"Very Dissatisfied\" or \"Somewhat Dissatisfied\" ") +
  xlab(" ") +
  ggtitle("\nTransportation - dissatisfaction?\n") +
  #scale_fill_discrete(name = "", labels = c("Y in '14, N in '15", "No change", "N in '14, Y in '15")) +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, vjust=.5, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")

```

Q17: Hard to get to appts./work last 2 weeks?
```{r, message = FALSE, echo=FALSE, fig.height=3, fig.width=9}


x <- c("Q17")

Q17Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q17_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q17_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("b. Yes, 1 time", "c. Yes, 2 times", "d. Yes, 3 times", "e. Yes, 4 times or more")]))
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("a. No, never")]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
 
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("b. Yes, 1 time", "c. Yes, 2 times", "d. Yes, 3 times", "e. Yes, 4 or more times")]), na.rm = TRUE)
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("a. No, never")]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}



pct_Yes_bsh <- pct_Yes_nonbsh <- c()

pct_Yes_bsh[1] <- Q17Yes()[1]
pct_Yes_nonbsh[1] <- Q17Yes()[2]

N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")


ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes") +
  xlab("") +
  ggtitle("\nHard to get to appts./work last 2 weeks?\n") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")

```


Q18: Transportation barriers
```{r, message = FALSE, echo=FALSE, fig.height=10, fig.width=9, warning=FALSE}

percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))

  yes_bsh <- as.integer(summary(as.factor(bsh_a))["Yes"])
  no_bsh <- as.integer(summary(as.factor(bsh_a))["No"])
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["Yes"])
  no_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["No"])
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q18_1: Live far from work, grocery store, etc.", 
       "Q18_2: Personal or family members’ health", 
       "Q18_3: Bus stops are too far", 
       "Q18_4: Bus schedule is not convenient",
       "Q18_5: Bus fares", 
       "Q18_6: Gas costs", 
       "Q18_7: Don’t have a bike", 
       "Q18_8: Don’t have a car",
       "Q18_9: Don’t have a ride", 
       "Q18_10: Don’t know how to get to places")


pct_Yes_bsh <- pct_Yes_nonbsh <- c()
for(i in 1:10) {
  pct_Yes_bsh[i] <- percentYes(18, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(18, i)[2]
}
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "%; N=", as.character(d$N), sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes") +
  xlab(" ") +
  ggtitle("\nIs this a barrier to SS in transportation?\n") +
  #scale_fill_discrete(name = "", labels = c("Y in '14, N in '15", "No change", "N in '14, Y in '15")) +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.8), hjust=0.5, vjust=.1, size=3, alpha=1) +
  scale_y_continuous(breaks= pretty_breaks()) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")

```

### **Childcare**
Q19: Children <13?
```{r, message = FALSE, echo=FALSE, fig.height=3, fig.width=9}

x <- c("Q19")

Q19Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q19_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q19_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("Yes")]))
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("No")]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("Yes")]))
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("No")]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}



pct_Yes_bsh <- pct_Yes_nonbsh <- c()

pct_Yes_bsh[1] <- Q19Yes()[1]
pct_Yes_nonbsh[1] <- Q19Yes()[2]

N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes") +
  xlab("") +
  ggtitle("\nChildren <13?\n") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")

```

Q20: Childcare sufficient?
```{r, message = FALSE, echo=FALSE, fig.height=3, fig.width=9}

x <- c("Q20")

Q20Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q20_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q20_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("a. Yes, I currently have sufficient child care")]), na.rm = TRUE)
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("b. No, I currently have some child care, but need more", "c. No, I currently have no child care, but need it", "d. N/A, I currently do not need child care")]), na.rm = TRUE)
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("a. Yes, I currently have sufficient child care")]), na.rm = TRUE)
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("b. No, I currently have some child care, but need more", "c. No, I currently have no child care, but need it", "d. N/A, I currently do not need child care")]), na.rm = TRUE)
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}



pct_Yes_bsh <- pct_Yes_nonbsh <- c()

pct_Yes_bsh[1] <- Q20Yes()[1]
pct_Yes_nonbsh[1] <- Q20Yes()[2]

N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")


ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes") +
  xlab("") +
  ggtitle("\nChildcare sufficient?\n") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")

```


Q21: Evaluate childcare
```{r, message = FALSE, echo=FALSE, fig.height=4.5, fig.width=9, warning=FALSE}



percentSatisfied <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  vg_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("d. Poor", "e. Very poor")]), na.rm = TRUE)
  g_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("a. Very good", "b. Good", "c. Neutral")]), na.rm = TRUE)
  tot_bsh <- length(nonbsh_a) - length(bsh_a[is.na(bsh_a)])
  percent_y_bsh <- (vg_bsh)* 100 / (vg_bsh + g_bsh)
  
  vg_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("d. Poor", "e. Very poor")]), na.rm = TRUE)
  g_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("a. Very good", "b. Good", "c. Neutral")]), na.rm = TRUE)
  tot_nonbsh <- length(nonbsh_a) - length(nonbsh_a[is.na(nonbsh_a)])
  percent_y_nonbsh <- (vg_nonbsh)* 100 / (vg_nonbsh + g_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q21_1: Accessibility", 
       "Q21_2: Quality", 
       "Q21_3: Affordability")

pct_Satisfied_bsh <- pct_Satisfied_nonbsh <- c()
for(i in 1:3) {
  pct_Satisfied_bsh[i] <- percentSatisfied(21, i)[1]
  pct_Satisfied_nonbsh[i] <- percentSatisfied(21, i)[2]
}

N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Satisfied_bsh, pct_Satisfied_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Satisfied")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Satisfied, 0)), "% (N=", as.character(d$N), ")", sep="")


ggplot(d, aes(reorder(Question, Percent_Satisfied), Percent_Satisfied, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered\n\"Very good\" or \"Good\" ") +
  xlab(" ") +
  ggtitle("\nEvaluate Childcare?\n") +
  #scale_fill_discrete(name = "", labels = c("Y in '14, N in '15", "No change", "N in '14, Y in '15")) +
  geom_text(aes(y = Percent_Satisfied, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.9), hjust=1, vjust=.5, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")

```

Q22: Barriers to childcare?
```{r, message = FALSE, echo=FALSE, fig.height=5, fig.width=9, warning=FALSE}
#summary(as.factor(bsh$Q22_2_17))
#summary(as.factor(bsh$Q22_2_15))
#length(bsh$Q22_2_15) - length(bsh$Q22_2_15[is.na(bsh$Q22_2_15)])
#summary(as.factor(bsh$Q22_1_17))
#summary(as.factor(bsh$Q22_1_15))



percentSatisfied <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  vg_bsh <- as.integer(summary(as.factor(bsh_a))[2])
  g_bsh <- as.integer(summary(as.factor(bsh_a))[1])
  tot_bsh <- length(bsh_a) - length(bsh_a[is.na(bsh_a)])
  percent_y_bsh <- (vg_bsh + g_bsh)* 100 / (tot_bsh)
  
  vg_nonbsh <- as.integer(summary(as.factor(nonbsh_a))[2])
  g_nonbsh <- as.integer(summary(as.factor(nonbsh_a))[1])
  tot_nonbsh <- length(nonbsh_a) - length(nonbsh_a[is.na(nonbsh_a)])
  percent_y_nonbsh <- (vg_nonbsh + g_nonbsh)* 100 / (tot_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q22_1: Accessibility", 
       "Q22_2: Quality", 
       "Q22_3: Affordability")

pct_Satisfied_bsh <- pct_Satisfied_nonbsh <- c()
for(i in 1:3) {
  pct_Satisfied_bsh[i] <- percentSatisfied(22, i)[1]
  pct_Satisfied_nonbsh[i] <- percentSatisfied(22, i)[2]
}

N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Satisfied_bsh, pct_Satisfied_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Satisfied")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Satisfied, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Satisfied), Percent_Satisfied, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered\n\"Definitely not\" or \"Probably not\" ") +
  xlab(" ") +
  ggtitle("\nIs this a Barrier to Childcare?\n") +
  scale_fill_discrete(name = "", labels = c("pct_NO_bsh", "pct_NO_2015")) +
  geom_text(aes(y = Percent_Satisfied, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.9), hjust=1, vjust=.5, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), labels = c("pct_NO_bsh", "pct_NO_2015", "pct_NO_nonbsh"), name="")

```


### **Support networks**
Q23: Help in last 3 months
```{r, message = FALSE, echo=FALSE, fig.height=7, fig.width=9, warning=FALSE}
#summary(bsh$Q23_5_17)
#summary(bsh$Q23_5_15)


percentNever <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  g_bsh <- as.integer(summary(as.factor(bsh_a))["a. Never"])
  tot_bsh <- length(bsh_a) - length(bsh_a[is.na(bsh_a)])
  percent_y_bsh <- (g_bsh)* 100 / (tot_bsh)
  
  g_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["a. Never"])
  tot_nonbsh <- length(nonbsh_a) - length(nonbsh_a[is.na(nonbsh_a)])
  percent_y_nonbsh <- (g_nonbsh)* 100 / (tot_nonbsh)
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q23_1: Church", 
       "Q23_2: Charitable organization", 
       "Q23_3: Local support group", 
       "Q23_4: Family", 
       "Q23_5: Friends/Neighbors")

pct_Never_bsh <- pct_Never_2015 <- pct_Never_nonbsh <- c()
for(i in 1:5) {
  pct_Never_bsh[i] <- percentNever(23, i)[1]
  pct_Never_nonbsh[i] <- percentNever(23, i)[2]
}

N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 

d <- data.frame(Question = x, pct_Never_bsh, pct_Never_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Never")
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Never, 0)), "% (N=", as.character(d$N), ")", sep="")


ggplot(d, aes(reorder(Question, Percent_Never), Percent_Never, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered\n\"Never\" ") +
  xlab(" ") +
  ggtitle("\nHave you received help in last 3 months from ...?\n") +
  scale_fill_discrete(name = "", labels = c("pct_NO_bsh", "pct_NO_2015")) +
  geom_text(aes(y = Percent_Never, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.9), hjust=1, vjust=.5, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="", labels = c("pct_NO_bsh", "pct_NO_2015", "pct_NO_nonbsh"))

```


```{r, echo=FALSE}
levQ23_17 <- c("Never", "1-2 times", "3-4 times",  "5-6 times", "7 times or more")

```

Q24: Network Barriers
```{r, message = FALSE, echo=FALSE, fig.height=7.5, fig.width=9, warning=FALSE}



percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  g_bsh <- as.integer(summary(as.factor(bsh_a))["Yes"])
  tot_bsh <- length(bsh_a) - length(bsh_a[is.na(bsh_a)])
  percent_y_bsh <- (g_bsh)* 100 / (tot_bsh)
  
  g_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["Yes"])
  tot_nonbsh <- length(nonbsh_a) - length(nonbsh_a[is.na(nonbsh_a)])
  percent_y_nonbsh <- (g_nonbsh)* 100 / (tot_nonbsh)
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q24_1: Living far from family/friends", 
       "Q24_2: Living far from community organizations", 
       "Q24_3: Living far from people who share my interests", 
       "Q24_4: Cannot afford social events", 
       "Q24_5: Not having enough time for social events",
       "Q24_6: Don’t know how to find community organizations")


pct_Yes_bsh <- pct_Yes_nonbsh <- c()
for(i in 1:6) {
  pct_Yes_bsh[i] <- percentYes(24, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(24, i)[2]
}

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")

N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 


d$N <- c(N_bsh, N_nonbsh)

d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered\n\"Yes\" ") +
  xlab(" ") +
  ggtitle("\nIs this a Barrier to Networking?\n") +
  scale_fill_discrete(name = "", labels = c("pct_Yes_bsh", "pct_Yes_2015")) +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, vjust=.5, size=3, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")

```

Q25: Types of support

```{r, message = FALSE, echo=FALSE, fig.width=9, fig.height=8, warning=FALSE}



percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  g_bsh <- as.integer(summary(as.factor(bsh_a))["Yes"])
  tot_bsh <- length(bsh_a) - length(bsh_a[is.na(bsh_a)])
  percent_y_bsh <- (g_bsh)* 100 / (tot_bsh)
 
  g_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["Yes"])
  tot_nonbsh <- length(nonbsh_a) - length(nonbsh_a[is.na(nonbsh_a)])
  percent_y_nonbsh <- (g_nonbsh)* 100 / (tot_nonbsh)
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q25_1: SNAP (Food\nStamps)", 
       "Q25_2: Medicaid", 
       "Q25_3: CHP+ (Colorado\nHealth Plan Plus)", 
       "Q25_4: LEAP (Energy\nassistance)", 
       "Q25_5: Free/reduced\nlunch",
       "Q25_6: TANF (Temporary\nAid to Needy Families)",
       "Q25_6: CCAP (Child Care\nAssistance Program)")

pct_Yes_bsh <- pct_Yes_nonbsh <- c()
for(i in 1:7) {
  pct_Yes_bsh[i] <- percentYes(25, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(25, i)[2]
}

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "%; N=", as.character(d$N), sep="")
#d$Percent_Yes_text[d$Percent_Yes_text=="0% (N=53)"] <- ""

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered\n\"Yes\" ") +
  xlab(" ") +
  ggtitle("\nDo you receive the following support?\n") +
  scale_fill_discrete(name = "", labels = c("pct_Yes_bsh", "pct_Yes_2015", "pct_Yes_nonbsh")) +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=.4, vjust=.1, size=3, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")
```


### **Legal**
Q26: Legal
```{r, message = FALSE, echo=FALSE, fig.height=3, fig.width=9}


  
x <- c("Q26")

Q26Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q26_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q26_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("c. I currently have a legal problem and do not have legal assistance")]), na.rm = TRUE)
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("a. I do not currently have a legal issue.", "b. I currently have legal issues and have legal assistance.")]), na.rm = TRUE)
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("c. I currently have a legal problem and do not have legal assistance")]), na.rm = TRUE)
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("a. I do not currently have a legal issue.", "b. I currently have legal issues and have legal assistance.")]), na.rm = TRUE)
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}



pct_Yes_bsh <- pct_Yes_nonbsh <- c()

pct_Yes_bsh[1] <- Q26Yes()[1]
pct_Yes_nonbsh[1] <- Q26Yes()[2]

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes") +
  xlab("") +
  ggtitle("\nDo you currently have a legal issue\n and do not have legal assistance?") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")

```

Q27: Barriers to resolving legal issues
```{r, message = FALSE, echo=FALSE, fig.height=5, fig.width=9, warning=FALSE}

percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  y_bsh <- as.integer(summary(as.factor(bsh_a))["Yes"])
  tot_bsh <- length(bsh_a) - length(bsh_a[is.na(bsh_a)])
  percent_y_bsh <- (y_bsh)* 100 / (tot_bsh)
  
  y_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["Yes"])
  tot_nonbsh <- length(nonbsh_a) - length(nonbsh_a[is.na(nonbsh_a)])
  percent_y_nonbsh <- (y_nonbsh)* 100 / (tot_nonbsh)
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q27_1: Don’t know how to access\nappropriate legal assistance", 
       "Q27_2: Don’t have money to pay\nfor appropriate legal assistance", 
       "Q27_3: Don’t trust that legal\nassistance will help me", 
       "Q27_4: Don’t know how to effectively\ncommunicate (language barrier)")

pct_Yes_bsh <- pct_Yes_nonbsh <- c()
for(i in 1:4) {
  pct_Yes_bsh[i] <- percentYes(27, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(27, i)[2]
}
d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered\n\"Yes\" ") +
  xlab(" ") +
  ggtitle("\nIs this a barrier to resolving legal issues?\n") +
  scale_fill_discrete(name = "", labels = c("pct_Yes_bsh", "pct_Yes_2015", "pct_Yes_nonbsh")) +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, vjust=.5, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")


```



### **Health**


```{r, message = FALSE, echo=FALSE, fig.height=4, fig.width=9, warning=FALSE}

x <- c("Q28: Do you have anyone in your\nhousehold who does not have Health Insurance?", 
       "Q29: Rate your current health.\n(\"Quite poor\" or \"Poor\"?)",
       "Q31: Did you have a medical problem and\nnot go to a doctor in last one year?")

Q28Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q28_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q28_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("All the members of our household have health insurance coverage, but the coverage is not adequate.", 
                                                     "Some of the members of our household do not have health insurance coverage.",
                                                     "Most of the members of our household do not have health insurance coverage.", 
                                                     "None of the members in our household has health insurance coverage.")]), na.rm = TRUE)
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("All the members of our household are covered by adequate health insurance coverage.")]), na.rm = TRUE)
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("All the members of our household have health insurance coverage, but the coverage is not adequate.", 
                                                     "Some of the members of our household do not have health insurance coverage.",
                                                     "Most of the members of our household do not have health insurance coverage.", 
                                                     "None of the members in our household has health insurance coverage.")]), na.rm = TRUE)
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("All the members of our household are covered by adequate health insurance coverage.")]), na.rm = TRUE)
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

Q29Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q29_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q29_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("1. Quite poor", "2. Poor")]), na.rm = TRUE)
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("3. Neutral", "4. Good", "5. Excellent")]), na.rm = TRUE)
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("1. Quite poor", "2. Poor")]), na.rm = TRUE)
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("3. Neutral", "4. Good", "5. Excellent")]), na.rm = TRUE)
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

Q31Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q31_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q31_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("Yes")]))
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))["No"]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("Yes")]))
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))["No"]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}


pct_Yes_bsh <- pct_Yes_nonbsh <- c()

pct_Yes_bsh[1] <- Q28Yes()[1]
pct_Yes_nonbsh[1] <- Q28Yes()[2]
pct_Yes_bsh[2] <- Q29Yes()[1]
pct_Yes_nonbsh[2] <- Q29Yes()[2]
pct_Yes_bsh[3] <- Q31Yes()[1]
pct_Yes_nonbsh[3] <- Q31Yes()[2]

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "%; N=", as.character(d$N), sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes ") +
  xlab("") +
  ggtitle("\nHealth\n") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=3, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")


```


### **Education**

```{r, message = FALSE, echo=FALSE, fig.height=4, fig.width=9, warning=FALSE}
x <- c("Q32: Highest level of education -\n(High school diploma/GED or higher?)", 
       "Q33: Do you have vocational\nqualification?", 
       "Q34: Are you planning to advance\nyour education or skills?")

```

```{r, message = FALSE, echo=FALSE, fig.height=4.5, fig.width=9, warning=FALSE}

Q32Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q32_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q32_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("a. Graduate degree (Master’s/Ph.D.)", 
                                                     "b. Undergraduate degree (Bachelor’s/Associate’s)", 
                                                     "c. Some college", 
                                                     "d. High school diploma or GED")]), na.rm = TRUE)
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("e. Did not graduate from high school")]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("a. Graduate degree (Master’s/Ph.D.)", 
                                                     "b. Undergraduate degree (Bachelor’s/Associate’s)", 
                                                     "c. Some college", 
                                                     "d. High school diploma or GED")]), na.rm = TRUE)
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("e. Did not graduate from high school")]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

Q33Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q33_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q33_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("a. Yes, I got it more than a year ago",
                                                     "b. Yes, I got it during the last year")]), na.rm = TRUE)
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("c. No, but I am planning to get it", 
                                                    "d. No, I am not planning to get it", 
                                                    "e. No, I am not sure if I need it")]), na.rm = TRUE)
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  

  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("a. Yes, I got it more than a year ago",
                                                     "b. Yes, I got it during the last year")]), na.rm = TRUE)
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("c. No, but I am planning to get it", 
                                                    "d. No, I am not planning to get it", 
                                                    "e. No, I am not sure if I need it")]), na.rm = TRUE)
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

Q34Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q34_17"))
  nonbsh_a <-eval(parse(text = "bsh$Q34_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))[c("Yes")]))
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))["No"]))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))[c("Yes")]))
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))["No"]))
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}


pct_Yes_bsh <- pct_Yes_nonbsh <- c()

pct_Yes_bsh[1] <- Q28Yes()[1]
pct_Yes_nonbsh[1] <- Q28Yes()[2]
pct_Yes_bsh[2] <- Q29Yes()[1]
pct_Yes_nonbsh[2] <- Q29Yes()[2]
pct_Yes_bsh[3] <- Q31Yes()[1]
pct_Yes_nonbsh[3] <- Q31Yes()[2]

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "%  N=", as.character(d$N), sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes ") +
  xlab("") +
  ggtitle("\nEducation\n") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")



```


Q35: Barriers for you to advance your education or skills? 
```{r, message = FALSE, echo=FALSE, fig.height=11, fig.width=9, warning=FALSE}

percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  y_bsh <- as.integer(summary(as.factor(bsh_a))["Yes"])
  tot_bsh <- length(bsh_a) - length(bsh_a[is.na(bsh_a)])
  percent_y_bsh <- (y_bsh)* 100 / (tot_bsh)
  
  y_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["Yes"])
  tot_nonbsh <- length(nonbsh_a) - length(nonbsh_a[is.na(nonbsh_a)])
  percent_y_nonbsh <- (y_nonbsh)* 100 / (tot_nonbsh)
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q35_1: Lack of time or energy", 
       "Q35_2: Cost", 
       "Q35_3: Responsibility for children", 
       "Q35_4: Lack of interest/motivation",
       "Q35_5: Lack of study skills", 
       "Q35_6: No place at home to study", 
       "Q35_7: Lack of transportation", 
       "Q35_8: Don’t know which type of education\nwould help me get a better paying job",
       "Q35_9: Lack of English proficiency", 
       "Q35_10: Personal or family issues", 
       "Q35_11: Health issues", 
       "Q35_12: Immigration status")



pct_Yes_bsh <- pct_Yes_nonbsh <- c()
for(i in 1:12) {
  pct_Yes_bsh[i] <- percentYes(35, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(35, i)[2]
}
d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "%; N=", as.character(d$N), sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered\n\"Yes\" ") +
  xlab(" ") +
  ggtitle("\nIs this a barrier to advancing\nyour education or skills?\n") +
  scale_fill_discrete(name = "", labels = c("pct_Yes_bsh", "pct_Yes_2015")) +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.8), hjust=1, vjust=.5, size=3, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")


```

### **Self Assessment**
```{r, message = FALSE, echo=FALSE, fig.height=9.5, fig.width=9, warning=FALSE}

percentYes <- function(qn, i) {
  bsh_a <-eval(parse(text = paste0("bsh$Q", as.character(qn), "_", as.character(i), "_17")))
  nonbsh_a <-eval(parse(text = paste0("nonbsh$Q", as.character(qn), "_", as.character(i), "_17")))
  
  #bsh_a <- ordered(bsh_a, levels=bsh_a_lev14, labels=a15_lev15)
  #a15 <- ordered(a15, levels=a15_lev15, labels=a15_lev15)

  one_bsh <- as.integer(summary(as.factor(bsh_a))["1. Urgent situation, currently in crisis"])
  two_bsh <- as.integer(summary(as.factor(bsh_a))["2. Vulnerable, need support to move forward"])
  thr_bsh <- as.integer(summary(as.factor(bsh_a))["3. Safe, family is making progress towards stability"])
  y_bsh <- sum(one_bsh, two_bsh, thr_bsh, na.rm = TRUE)
  tot_bsh <- length(bsh_a) - length(bsh_a[is.na(bsh_a)])
  percent_y_bsh <- (y_bsh)* 100 / (tot_bsh)
  
  one_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["1. Urgent situation, currently in crisis"])
  two_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["2. Vulnerable, need support to move forward"])
  thr_nonbsh <- as.integer(summary(as.factor(nonbsh_a))["3. Safe, family is making progress towards stability"])
  y_nonbsh <- sum(one_nonbsh, two_nonbsh, thr_nonbsh, na.rm = TRUE)
  tot_nonbsh <- length(nonbsh_a) - length(nonbsh_a[is.na(nonbsh_a)])
  percent_y_nonbsh <- (y_nonbsh)* 100 / (tot_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}

x <- c("Q36_1: Housing", 
       "Q36_2: Employment", 
       "Q36_3: Income", 
       "Q36_4: Food",
       "Q36_5: Transportation", 
       "Q36_6: Childcare", 
       "Q36_7: Support networks", 
       "Q36_8: Legal",
       "Q36_9: Health", 
       "Q36_10: Education", 
       "Q36_11: Immigration status")



pct_Yes_bsh <- pct_Yes_nonbsh <- c()
for(i in 1:11) {
  pct_Yes_bsh[i] <- percentYes(36, i)[1]
  pct_Yes_nonbsh[i] <- percentYes(36, i)[2]
}
d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered\n\"Urgent\" , \"Vulnerable\" or \"Safe\" ") +
  xlab(" ") +
  ggtitle("\nSelf-assessment of Self-Sufficiency in...\n") +
  scale_fill_discrete(name = "", labels = c("pct_Yes_bsh", "pct_Yes_2015", "pct_Yes_2015")) +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.8), hjust=1, vjust=.5, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")


```

### **Hispanic/Latino?**

Q38: Hispanic/Latino?

```{r, message = FALSE, echo=FALSE, fig.height=2.5, fig.width=9}

  
x <- c("Q38")

Q38Yes <- function() {
  bsh_a <-eval(parse(text = "bsh$Q38_17"))
  nonbsh_a <-eval(parse(text = "nonbsh$Q38_17"))
  
  yes_bsh <- sum(as.integer(summary(as.factor(bsh_a))["Yes"]), na.rm = TRUE)
  no_bsh <- sum(as.integer(summary(as.factor(bsh_a))["No"], na.rm = TRUE))
  percent_y_bsh <- (yes_bsh)* 100 / (yes_bsh + no_bsh)
  
  yes_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))["Yes"]), na.rm = TRUE)
  no_nonbsh <- sum(as.integer(summary(as.factor(nonbsh_a))["No"]), na.rm = TRUE)
  percent_y_nonbsh <- (yes_nonbsh)* 100 / (yes_nonbsh + no_nonbsh)
  
  return(c(percent_y_bsh, percent_y_nonbsh))
}



pct_Yes_bsh <- pct_Yes_nonbsh <- c()

pct_Yes_bsh[1] <- Q38Yes()[1]
pct_Yes_nonbsh[1] <- Q38Yes()[2]

d <- data.frame(Question = x, pct_Yes_bsh, pct_Yes_nonbsh)
d <- melt(d, id.vars = "Question", variable.name="BSH_NonBSH", value.name="Percent_Yes")
N_bsh <- NA
N_nonbsh <- NA
for(i in 1:length(x)) {
  N_bsh[i] <- eval(parse(text = paste0("length(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(bsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
  
  N_nonbsh[i] <- eval(parse(text = paste0("length(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17[!is.na(nonbsh$", strsplit(x[i], ":", fixed = FALSE)[[1]][1], "_17)])", sep = "")))
} 
d$N <- c(N_bsh, N_nonbsh)
d$Percent_Yes_text <- paste0(as.character(round(d$Percent_Yes, 0)), "% (N=", as.character(d$N), ")", sep="")

ggplot(d, aes(reorder(Question, Percent_Yes), Percent_Yes, group=BSH_NonBSH)) + geom_bar(stat = "identity", width = 0.7, position="dodge", aes(fill=BSH_NonBSH), alpha=1) +
  theme(
    plot.title = element_text(size=16, face="bold", vjust=3, color = "dodgerblue4"), 
    axis.text.x = element_text(size=11, face="bold", angle = 0, hjust = 1), 
    axis.text.y = element_text(size=11, face="bold", color = "black"), 
    axis.title.x = element_text(size=12, face = "bold"), 
    axis.title.y = element_text(size=12, vjust=2, face = "bold"),
    legend.title=element_blank(),
    legend.text = element_text(size = 12)) +
  coord_flip() +
  ylab("\nPercentage who answered Yes") +
  xlab("") +
  ggtitle("\nHispanic/Latino?") +
  geom_text(aes(y = Percent_Yes, label=Percent_Yes_text), stat="identity", position=position_dodge(width = 0.7), hjust=1, size=4, alpha=1) +
  scale_fill_manual(values = c("aquamarine3", "aquamarine4"), name="")



```


